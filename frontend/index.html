{% extends "layout.html" %}

{% block content %}
<div id="dashboard-page">
    <div class="row mb-4 text-center">
        <div class="col">
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-primary active px-4" id="btn-mode-sign2text">Sign to Text</button>
                <button type="button" class="btn btn-outline-primary px-4" id="btn-mode-text2sign">Text to Sign</button>
            </div>
        </div>
    </div>

    <div class="row main-content-row">
        <div class="col-md-7 left-panel">
            
            <div id="sign-to-text-view">
                <div class="video-wrapper mb-3">
                    <video id="video" autoplay playsinline></video>
                    <canvas id="canvas" width="640" height="480" style="display:none;"></canvas>
                </div>

                <div class="d-flex justify-content-between align-items-end mb-2 px-1">
                    <div>
                        <span class="text-muted small text-uppercase fw-bold ls-1">Detected Sign</span>
                        <h2 id="current-prediction" class="text-dark fw-bold display-6 mb-0">...</h2>
                    </div>
                </div>
                
                <div class="progress mb-4" style="height: 6px; background-color: #e2e8f0;">
                    <div id="stability-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%"></div>
                </div>

                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom fw-bold text-secondary">Sentence Builder</div>
                    <div class="card-body">
                        <textarea id="output_text" class="form-control mb-3 fs-5" rows="2" placeholder="Start signing to build a sentence..."></textarea>
                        <div class="d-flex gap-2 flex-wrap">
                            <button class="btn btn-outline-secondary flex-grow-1" id="btn-space">Space</button>
                            <button class="btn btn-outline-secondary flex-grow-1" id="btn-backspace"><i class="fas fa-backspace"></i></button>
                            <button class="btn btn-outline-danger" id="btn-clear">Clear</button>
                            <button class="btn btn-primary flex-grow-1 fw-bold" id="btn-speak"><i class="fas fa-volume-up me-2"></i>Speak</button>
                            <button class="btn btn-outline-dark" onclick="saveToHistory('output_text', 'Sign-to-Text')"><i class="fas fa-save"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="text-to-sign-view" style="display: none;">
                 <div class="p-4 shadow-sm rounded bg-white text-center border">
                    <h4 class="text-dark mb-4">Type to Translate</h4>
                    <input type="text" id="text-input" class="form-control form-control-lg mb-4 bg-light" placeholder="Type letters A-Z here...">
                    
                    <div class="d-flex justify-content-center gap-2 mb-4">
                        <button class="btn btn-outline-success" onclick="saveToHistory('text-input', 'Text-to-Sign')">Save to History</button>
                        <button class="btn btn-primary fw-bold" id="btn-visual-play"><i class="fas fa-play me-2"></i>Play Sequence</button>
                    </div>
                    
                    <div id="current-sign-display" class="border bg-light rounded p-3 d-flex flex-column align-items-center justify-content-center" style="min-height: 300px;">
                         <img id="main-sign-image" src="https://via.placeholder.com/200?text=Ready" alt="Sign" class="img-fluid rounded shadow-sm" style="max-height: 250px;">
                         <h2 id="main-sign-letter" class="mt-3 text-primary display-4 fw-bold">-</h2>
                    </div>
                 </div>
            </div>
        </div>

        <div class="col-md-5 right-panel overflow-auto" style="max-height: 85vh;">
            <h6 class="text-center sticky-top bg-body py-3 border-bottom text-uppercase text-secondary fw-bold small ls-1">Reference Guide</h6>
            <div class="reference-grid p-2" id="reference-grid"></div>
        </div>
    </div>
</div>
{% endblock %}